jQuery(document).ready(function(n){"use strict";n.wc_product_vendors_admin={init:function(){function t(n,t){var e=document.createElement("a"),a=document.createEvent("HTMLEvents");a.initEvent("click"),e.download=n,e.href=t,e.dispatchEvent(a)}if(n("#your-profile tr.show-admin-bar").remove(),wcpv_admin_local.isPendingVendor&&n("#dashboard-widgets").html('<p class="wcpv-pending-vendor-message">'+wcpv_admin_local.pending_vendor_message+"</p>"),n(".taxonomy-wcpv_product_vendors, .toplevel_page_wcpv-vendor-settings").on("click",".wcpv-upload-logo",function(t){t.preventDefault();var e=wcpv_admin_local,a=n(this).parents(".form-field").find('input[name="vendor_data[logo]"]'),o=n(this).parents(".form-field").find(".wcpv-logo-preview-image"),i=wp.media.frames.mediaFrame=wp.media({title:e.modalLogoTitle,button:{text:e.buttonLogoText},library:{type:"image"},multiple:!1});i.on("select",function(){var t=i.state().get("selection");t.map(function(t){t=t.toJSON(),t.id&&(a.val(t.id),o.prop("src",t.url).removeClass("hide"),n(a).parents(".form-field").find(".wcpv-remove-image").show())})}),i.open()}),n(".taxonomy-wcpv_product_vendors, .toplevel_page_wcpv-vendor-settings").on("click",".wcpv-remove-image",function(t){t.preventDefault(),n(this).hide(),n(this).parents(".form-field").find(".wcpv-logo-preview-image").prop("src","").addClass("hide"),n('input[name="vendor_data[logo]"]').val("")}),n(document.body).on("variable_vendor_commission",function(t){var e=window.prompt(woocommerce_admin_meta_boxes_variations.i18n_enter_a_value);null!=e&&n(':input[name^="_wcpv_product_variation_commission"]').val(e).change()}),n(".chart-widget .wcpv-vendor-search").length){var e={formatMatches:function(n){return 1===n?wcpv_admin_local.i18n_matches_1:wcpv_admin_local.i18n_matches_n.replace("%qty%",n)},formatNoMatches:function(){return wcpv_admin_local.i18n_no_matches},formatAjaxError:function(){return wcpv_admin_local.i18n_ajax_error},formatInputTooShort:function(n,t){var e=t-n.length;return 1===e?wcpv_admin_local.i18n_input_too_short_1:wcpv_admin_local.i18n_input_too_short_n.replace("%qty%",e)},formatInputTooLong:function(n,t){var e=n.length-t;return 1===e?wcpv_admin_local.i18n_input_too_long_1:wcpv_admin_local.i18n_input_too_long_n.replace("%qty%",e)},formatSelectionTooBig:function(n){return 1===n?wcpv_admin_local.i18n_selection_too_long_1:wcpv_admin_local.i18n_selection_too_long_n.replace("%qty%",n)},formatLoadMore:function(){return wcpv_admin_local.i18n_load_more},formatSearching:function(){return wcpv_admin_local.i18n_searching}};n(":input.wcpv-vendor-search").filter(":not(.enhanced)").each(function(){var t={allowClear:n(this).data("allow_clear")?!0:!1,placeholder:n(this).data("placeholder"),minimumInputLength:n(this).data("minimum_input_length")?n(this).data("minimum_input_length"):"3",escapeMarkup:function(n){return n},ajax:{url:wcpv_admin_local.ajaxurl,dataType:"json",quietMillis:250,data:function(n){return{term:n,action:"wcpv_vendor_search_ajax",security:wcpv_admin_local.vendor_search_nonce}},results:function(t){console.log(t);var e=[];return t&&n.each(t,function(n,t){e.push({id:n,text:t})}),{results:e}},cache:!0}};n(this).data("multiple")===!0?(t.multiple=!0,t.initSelection=function(t,e){var a=n.parseJSON(t.attr("data-selected")),o=[];return n(t.val().split(",")).each(function(n,t){o.push({id:t,text:a[t]})}),e(o)},t.formatSelection=function(n){return'<div class="selected-option" data-id="'+n.id+'">'+n.text+"</div>"}):(t.multiple=!1,t.initSelection=function(n,t){var e={id:n.val(),text:n.attr("data-selected")};return t(e)}),t=n.extend(t,e),n(this).select2(t).addClass("enhanced")})}n(document.body).on("click",".wcpv-export-commissions-button",function(e){e.preventDefault();var a={action:"wcpv_export_commissions_ajax",nonce:n(this).data("nonce"),order_id:n(this).data("order_id"),year:n(this).data("year"),month:n(this).data("month"),vendor:n(this).data("vendor"),commission_status:n(this).data("commission_status")},o=n(this).prop("download");n.post(wcpv_admin_local.ajaxurl,a).done(function(n){t(o,"data:application/csv;charset=utf-8,"+encodeURIComponent(n))})}),n(document.body).on("click",".wcpv-export-unpaid-commissions-button",function(e){e.preventDefault();var a={action:"wcpv_export_unpaid_commissions_ajax",nonce:n(this).data("nonce")},o=n(this).prop("download");n.post(wcpv_admin_local.ajaxurl,a).done(function(n){t(o,"data:application/csv;charset=utf-8,"+encodeURIComponent(n))})}),n("#wcpv_vendor_settings_paypal_masspay_environment").change(function(){var t=n("#wcpv_vendor_settings_paypal_masspay_client_id_live").parents("tr").eq(0),e=n("#wcpv_vendor_settings_paypal_masspay_client_secret_live").parents("tr").eq(0),a=n("#wcpv_vendor_settings_paypal_masspay_client_id_sandbox").parents("tr").eq(0),o=n("#wcpv_vendor_settings_paypal_masspay_client_secret_sandbox").parents("tr").eq(0);"sandbox"===n(this).val()?(t.hide(),e.hide(),a.show(),o.show()):(t.show(),e.show(),a.hide(),o.hide())}).change(),n(document.body).on("click",".wcpv-term-additional-settings-link",function(t){t.preventDefault(),n(".wcpv-term-additional-settings").slideToggle()})}},n.wc_product_vendors_admin.init()});